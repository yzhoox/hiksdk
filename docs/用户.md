```markdown
## 5.3 用户注册

### 5.3.1 通过解析服务器获取设备动态 IP 地址和端口号  
**函数：**  
`BOOL NET_DVR_GetDVRIPByResolveSvr_EX (char *sServerIP, WORD wServerPort, BYTE *sDVRName, WORD wDVRNameLen, BYTE *sDVRSerialNumber, WORD wDVRSerialLen, char *sGetIP, DWORD *dwPort)`

**参数说明：**

| 参数 | 方向 | 说明 |
|------|------|------|
| `sServerIP` | [in] | 解析服务器（IPServer 或 hkDDNS）的 IP 地址或域名 |
| `wServerPort` | [in] | 解析服务器端口号（IPServer 为 7071，hiDDNS 为 80） |
| `sDVRName` | [in] | 设备名称或设备域名 |
| `wDVRNameLen` | [in] | 设备名称长度 |
| `sDVRSerialNumber` | [in] | 设备序列号 |
| `wDVRSerialLen` | [in] | 序列号长度 |
| `sGetIP` | [out] | 解析得到的设备 IP 地址 |
| `dwPort` | [out] | 解析得到的设备端口号 |

**返回值：**  
- `TRUE`：成功  
- `FALSE`：失败（需调用 `NET_DVR_GetLastError` 获取错误码）

**说明：**  
- 设备名称 (`sDVRName`) 和序列号 (`sDVRSerialNumber`) **不能同时为空**  
- 可通过设备域名或序列号解析设备当前 IP 和端口  
- 获取到 IP 和端口后，需调用 `NET_DVR_Login_V40` 登录设备  
- 支持的解析服务器：**IPServer、hiDDNS**

---

### 5.3.2 用户注册设备 `NET_DVR_Login_V40`

**函数：**  
`LONG NET_DVR_Login_V40(LPNET_DVR_USER_LOGIN_INFO pLoginInfo, LPNET_DVR_DEVICEINFO_V40 lpDeviceInfo)`

**参数说明：**

| 参数 | 方向 | 说明 |
|------|------|------|
| `pLoginInfo` | [in] | 登录参数（设备地址、用户名、密码等） |
| `lpDeviceInfo` | [out] | 登录成功后输出的设备信息（同步模式下有效） |

**返回值：**

- **同步登录 (`bUseAsynLogin = 0`)：**  
  - 返回 `-1`：失败  
  - 返回其他值：用户 ID（UserID）
- **异步登录 (`bUseAsynLogin = 1`)：**  
  - 登录结果通过 `fLoginResultCallBack` 回调返回

**说明：**

- `bUseAsynLogin = 0` → 同步登录（接口返回即成功）  
- `bUseAsynLogin = 1` → 异步登录（回调返回状态）  
- 设备最多支持 **32 个注册用户名**  
- 最大同时允许 **128 个用户注册**  
- SDK 支持 **2048 个注册**（UserID 范围：0~2047）  

---

### 5.3.3 用户注销 `NET_DVR_Logout`

**函数：**  
`BOOL NET_DVR_Logout(LONG lUserID)`

**参数说明：**

| 参数 | 方向 | 说明 |
|------|------|------|
| `lUserID` | [in] | 用户 ID（由 `NET_DVR_Login_V40` 返回） |

**返回值：**  
- `TRUE`：成功  
- `FALSE`：失败（用 `NET_DVR_GetLastError` 获取原因）

**说明：**  
- 推荐使用此接口进行注销操作

```
